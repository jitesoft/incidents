const run=async()=>{const e=document.querySelector("template#incident"),t=(document.querySelector("template#label"),document.querySelector("#app")),r=new showdown.Converter,o=await(await fetch(`${config.baseUri}/${config.repo}/issues?state=all&sort=updated&per_page=${config.pagesize}&page=1&creator=${config.user}`)).json();for(const a of o){if(a.user.login.toLowerCase()!==config.user.toLowerCase())continue;const o=document.importNode(e.content,!0);o.querySelector('[data-ref="status"]').classList.add(a.state),o.querySelector('[data-ref="text"]').innerHTML=r.makeHtml(a.body),o.querySelector('[data-ref="status"]').innerText=a.state,o.querySelector('[data-ref="title"]').innerText=a.title,o.querySelector('[data-ref="created"]').innerText="Opened "+new Date(a.created_at).toLocaleString(),o.querySelector('[data-ref="updated"]').innerText="Updated "+new Date(a.updated_at).toLocaleString(),a.closed_at&&(o.querySelector('[data-ref="closed"]').innerText="Resolved "+new Date(a.closed_at).toLocaleString()),0!==a.comments&&(o.querySelector('[data-ref="comments"]').innerText="Comments",o.querySelector('[data-ref="comments"]').href=a.html_url);const n=o.querySelector('[data-ref="labels"]');for(const e of a.labels.slice(0,6)){const t=document.createElement("span");t.classList.add("label"),t.style.backgroundColor=`#${e.color}`,t.style.color="#"+(0&parseInt(e.color,16)|16777215&~parseInt(e.color,16)).toString(16),t.innerText=e.name,n.appendChild(t)}t.appendChild(o)}};run();
